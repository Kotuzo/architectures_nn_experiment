2017-04-30 00:48:44,560 - models - INFO -         Preparing data
2017-04-30 00:53:26,609 - models - INFO -         Preparing data
2017-04-30 00:53:27,325 - models - INFO -         create model 1...
2017-04-30 00:53:32,946 - models - INFO -         fit model...
2017-04-30 00:53:56,166 - models - INFO -         Preparing data
2017-04-30 00:53:56,824 - models - INFO -         create model 1...
2017-04-30 00:53:57,341 - models - INFO -         fit model...
2017-04-30 00:55:00,877 - models - INFO -         Preparing data
2017-04-30 00:55:01,597 - models - INFO -         create model 1...
2017-04-30 00:55:02,116 - models - INFO -         fit model...
2017-04-30 01:00:41,948 - models - INFO -         Preparing data
2017-04-30 01:00:42,661 - models - INFO -         create model 1...
2017-04-30 01:00:43,290 - models - INFO -         fit model...
2017-04-30 01:01:01,059 - models - INFO -         dumping history to catalog: ../history/model1
2017-04-30 01:04:07,147 - models - INFO -         Preparing data
2017-04-30 01:04:07,873 - models - INFO -         create model 1...
2017-04-30 01:04:08,534 - models - INFO -         fit model...
2017-04-30 01:04:16,486 - models - INFO -         dumping history to catalog: ../history/model1
2017-04-30 01:04:16,486 - models - INFO -         create model 2...
2017-04-30 01:04:17,391 - models - INFO -         fit model...
2017-04-30 01:04:45,830 - models - INFO -         dumping history to catalog: ../history/model2
2017-04-30 18:11:40,715 - models - INFO -         Preparing data
2017-04-30 18:11:42,564 - models - INFO -         create model 1...
2017-04-30 18:11:47,381 - models - INFO -         fit model...
2017-04-30 18:12:32,602 - models - INFO -         dumping history to catalog: ../history/model1
2017-04-30 18:12:32,610 - models - INFO -         create model 2...
2017-04-30 18:12:33,457 - models - INFO -         fit model...
2017-04-30 18:12:59,252 - models - INFO -         dumping history to catalog: ../history/model2
2017-04-30 18:20:23,305 - models - INFO -         Preparing data
2017-04-30 18:20:23,684 - models - INFO -         create model 1...
2017-04-30 18:20:24,201 - models - INFO -         fit model...
2017-04-30 18:20:27,881 - models - INFO -         dumping history to catalog: ../history/model1
2017-04-30 18:20:27,881 - models - INFO -         create model 2...
2017-04-30 18:20:28,614 - models - INFO -         fit model...
2017-04-30 18:20:36,151 - models - INFO -         dumping history to catalog: ../history/model2
2017-04-30 18:26:36,230 - models - INFO -         Preparing data
2017-04-30 18:26:36,608 - models - INFO -         create model 1...
2017-04-30 18:26:37,174 - models - INFO -         fit model...
2017-04-30 18:26:42,646 - models - INFO -         dumping history to catalog: ../history/model1
2017-04-30 18:26:42,647 - models - INFO -         create model 2...
2017-04-30 18:26:43,308 - models - INFO -         fit model...
2017-04-30 18:26:52,252 - models - INFO -         dumping history to catalog: ../history/model2
2017-04-30 18:27:10,011 - models - INFO -         Preparing data
2017-04-30 18:27:10,388 - models - INFO -         create model 1...
2017-04-30 18:27:10,949 - models - INFO -         fit model...
2017-04-30 18:31:44,474 - models - INFO -         Preparing data
2017-04-30 18:31:44,866 - models - INFO -         create model 1...
2017-04-30 18:31:45,400 - models - INFO -         fit model...
2017-04-30 19:30:57,327 - models - INFO -         dumping history to catalog: ../history/model1
2017-04-30 19:30:57,327 - models - INFO -         create model 2...
2017-04-30 19:30:58,055 - models - INFO -         fit model...
2017-04-30 22:47:31,376 - models - INFO -         dumping history to catalog: ../history/model2
2017-04-30 22:47:31,376 - models - INFO -         create model 3...
2017-04-30 22:47:31,604 - models - INFO -         fit model...
2017-04-30 23:46:52,926 - models - INFO -         dumping history to catalog: ../history/model3
2017-04-30 23:46:52,926 - models - INFO -         create model 4...
2017-04-30 23:46:53,564 - models - INFO -         fit model...
2017-05-01 02:39:05,022 - models - INFO -         dumping history to catalog: ../history/model4
2017-05-07 23:56:04,072 - __main__ - INFO -         using specific model
2017-05-07 23:56:04,081 - models - INFO -         Preparing data
2017-05-08 00:11:39,060 - __main__ - INFO -         using specific model
2017-05-08 00:11:39,060 - models - INFO -         Preparing data
2017-05-08 00:13:35,712 - __main__ - INFO -         using specific model
2017-05-08 00:13:35,712 - models - INFO -         Preparing data
2017-05-08 00:15:11,938 - __main__ - INFO -         using specific model
2017-05-08 00:15:11,939 - models - INFO -         Preparing data
2017-05-08 00:15:12,044 - models - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-08 00:15:12,045 - models - INFO -         50000train samples
2017-05-08 00:15:12,045 - models - INFO -         10000test samples
2017-05-08 00:17:27,717 - __main__ - INFO -         using specific model
2017-05-08 00:17:27,717 - models - INFO -         Preparing data
2017-05-08 00:17:27,827 - models - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-08 00:17:27,828 - models - INFO -         50000train samples
2017-05-08 00:17:27,828 - models - INFO -         10000test samples
2017-05-08 00:17:28,142 - models - INFO -         create model 5 alexnet...
2017-05-08 00:17:31,434 - models - INFO -         fit model...
2017-05-08 00:17:31,807 - theano.gof.opt - ERROR -         SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x7ff9760427b8>
2017-05-08 00:17:31,807 - theano.gof.opt - ERROR -         Traceback:
2017-05-08 00:17:31,819 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 235, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 83, in optimize
    self.add_requirements(fgraph)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1482, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/fg.py", line 541, in attach_feature
    attach(self)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1299, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1362, in on_import
    self.set_shape(r, s)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1151, in set_shape
    shape_vars.append(self.unpack(s[i], r))
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1073, in unpack
    raise ValueError(msg)
ValueError: There is a negative shape in the graph! 
Backtrace when that variable is created:

  File "/home/kotus/Experiment/code/arch_comp.py", line 26, in main
    models.run(int(arg))
  File "/home/kotus/Experiment/code/models.py", line 249, in run
    _choose_model(arg)
  File "/home/kotus/Experiment/code/models.py", line 244, in _choose_model
    return args[arg]()
  File "/home/kotus/Experiment/code/models.py", line 183, in _create_model_5
    _model.add(Convolution2D(192, (3, 3)))
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/models.py", line 463, in add
    output_tensor = layer(self.outputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 578, in __call__
    output = self.call(inputs, **kwargs)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/layers/convolutional.py", line 164, in call
    dilation_rate=self.dilation_rate)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/backend/theano_backend.py", line 1769, in conv2d
    filter_dilation=dilation_rate)


2017-05-08 00:17:31,932 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:31,932 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:17:31,932 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:31,932 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:17:31,935 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:31,935 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:17:31,935 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:31,935 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:17:31,944 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:31,944 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:17:31,944 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:31,944 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:17:31,949 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:31,950 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,3,1,2}.0)
2017-05-08 00:17:31,950 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:31,950 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,3,1,2}.0

2017-05-08 00:17:32,096 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:32,096 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:17:32,096 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,096 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:17:32,098 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:32,098 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:17:32,098 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,098 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:17:32,104 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:32,105 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:17:32,105 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,105 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:17:32,108 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:32,109 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 00:17:32,109 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,109 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 00:17:32,182 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:32,183 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:17:32,183 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,183 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:17:32,185 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:32,185 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:17:32,185 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,185 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:17:32,191 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:32,191 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:17:32,191 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,191 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:17:32,194 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:32,194 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 00:17:32,194 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,194 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 00:17:32,242 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,243 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,243 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,243 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:17:32,243 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,244 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,244 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,244 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:17:32,244 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,245 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,245 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,245 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:17:32,245 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,245 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,245 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,245 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:17:32,246 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,246 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,246 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,247 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,247 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,247 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,247 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,247 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,248 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,248 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,248 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,248 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,248 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,248 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,248 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,249 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,286 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,286 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,286 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,287 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:17:32,287 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,287 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,287 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,287 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:17:32,288 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,288 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,288 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,288 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:17:32,288 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,289 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,289 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,289 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:17:32,290 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,290 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,290 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,290 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,290 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,290 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,290 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,291 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,292 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,292 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,292 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,292 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,292 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,292 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,292 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,292 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,309 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,309 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,309 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,310 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,310 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,310 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,310 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,310 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,310 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,311 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,311 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,311 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,311 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,311 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,311 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,311 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,311 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,311 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,312 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,312 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:17:32,312 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,312 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,312 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,312 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:17:32,312 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,312 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,312 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,313 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:17:32,313 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,313 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,313 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,313 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:17:32,457 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:32,458 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:17:32,458 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,458 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:17:32,459 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:32,460 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:17:32,460 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,460 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:17:32,462 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,463 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,463 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,463 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:17:32,463 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,463 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,463 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,463 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:17:32,465 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,466 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,466 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,466 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:17:32,466 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,466 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,466 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,467 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:17:32,467 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:32,468 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:17:32,468 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,468 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:17:32,470 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,470 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,470 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,470 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,470 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,470 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,470 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,470 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,471 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:32,471 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 00:17:32,471 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,471 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 00:17:32,473 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,473 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,473 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,473 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,473 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,474 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,474 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,474 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,516 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:32,516 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:17:32,516 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,517 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:17:32,518 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:32,518 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:17:32,518 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,519 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:17:32,520 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,520 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,520 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,521 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:17:32,521 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,521 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,521 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,521 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:17:32,522 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,523 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,523 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,523 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:17:32,523 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,523 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,523 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,523 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:17:32,524 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:32,524 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:17:32,525 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,525 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:17:32,526 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,526 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,526 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,526 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,526 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,526 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,526 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,527 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,527 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:32,527 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 00:17:32,527 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,527 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 00:17:32,528 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,528 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,529 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,529 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,529 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,529 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,529 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,529 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,571 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:32,571 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:17:32,571 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,571 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:17:32,573 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:32,573 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:17:32,573 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,574 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:17:32,575 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,575 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,575 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,575 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:17:32,576 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,576 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,576 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,576 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:17:32,577 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,577 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,578 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,578 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:17:32,578 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,578 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,578 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,578 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:17:32,579 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:32,579 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:17:32,579 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,579 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:17:32,580 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,580 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,581 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,581 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,581 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,581 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,581 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,581 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,582 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:32,582 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 00:17:32,582 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,582 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 00:17:32,583 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,583 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,583 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,583 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,583 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,583 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,584 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,584 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,629 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:32,629 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:17:32,629 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,629 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:17:32,630 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:32,630 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:17:32,631 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,631 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:17:32,632 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,632 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,632 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,633 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:17:32,633 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,633 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,633 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,633 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:17:32,634 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,634 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,634 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,635 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:17:32,635 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,635 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,635 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,635 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:17:32,636 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:32,636 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:17:32,636 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,636 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:17:32,637 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,637 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,638 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,638 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,638 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,638 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,638 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,638 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,639 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:32,639 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 00:17:32,639 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,639 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 00:17:32,640 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,640 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,640 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,640 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,640 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,641 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,641 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,641 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,682 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:32,682 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:17:32,682 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,682 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:17:32,684 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:32,684 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:17:32,684 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,684 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:17:32,685 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,686 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,686 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,686 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:17:32,686 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,686 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,686 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,687 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:17:32,688 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,688 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,688 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,688 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:17:32,688 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,689 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:17:32,689 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,689 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:17:32,690 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:32,690 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:17:32,690 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,690 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:17:32,691 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,691 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,691 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,691 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,692 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,692 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,692 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,692 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,692 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:17:32,692 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 00:17:32,693 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,693 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 00:17:32,694 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,694 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,694 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,694 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:17:32,694 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:17:32,694 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:17:32,694 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:17:32,695 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:20:18,885 - __main__ - INFO -         using specific model
2017-05-08 00:20:18,885 - models - INFO -         Preparing data
2017-05-08 00:20:18,997 - models - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-08 00:20:18,997 - models - INFO -         50000train samples
2017-05-08 00:20:18,997 - models - INFO -         10000test samples
2017-05-08 00:20:19,309 - models - INFO -         create model 5 alexnet...
2017-05-08 00:20:20,136 - theano.gof.compilelock - WARNING -         Overriding existing lock by dead process '9304' (I am process '9412')
2017-05-08 00:20:20,522 - models - INFO -         fit model...
2017-05-08 00:20:20,881 - theano.gof.opt - ERROR -         SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x7fcb2e9f37b8>
2017-05-08 00:20:20,882 - theano.gof.opt - ERROR -         Traceback:
2017-05-08 00:20:20,882 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 235, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 83, in optimize
    self.add_requirements(fgraph)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1482, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/fg.py", line 541, in attach_feature
    attach(self)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1299, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1362, in on_import
    self.set_shape(r, s)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1151, in set_shape
    shape_vars.append(self.unpack(s[i], r))
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1073, in unpack
    raise ValueError(msg)
ValueError: There is a negative shape in the graph! 
Backtrace when that variable is created:

  File "/home/kotus/Experiment/code/arch_comp.py", line 26, in main
    models.run(int(arg))
  File "/home/kotus/Experiment/code/models.py", line 249, in run
    _choose_model(arg)
  File "/home/kotus/Experiment/code/models.py", line 244, in _choose_model
    return args[arg]()
  File "/home/kotus/Experiment/code/models.py", line 183, in _create_model_5
    _model.add(Convolution2D(192, (3, 3)))
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/models.py", line 463, in add
    output_tensor = layer(self.outputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 578, in __call__
    output = self.call(inputs, **kwargs)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/layers/convolutional.py", line 164, in call
    dilation_rate=self.dilation_rate)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/backend/theano_backend.py", line 1769, in conv2d
    filter_dilation=dilation_rate)


2017-05-08 00:20:21,000 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,000 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:20:21,000 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,000 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:20:21,002 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,002 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:20:21,003 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,003 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:20:21,012 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,012 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:20:21,012 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,013 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:20:21,017 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,017 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,3,1,2}.0)
2017-05-08 00:20:21,017 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,018 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,3,1,2}.0

2017-05-08 00:20:21,157 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,157 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:20:21,157 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,157 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:20:21,159 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,159 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:20:21,159 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,160 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:20:21,167 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,167 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:20:21,167 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,167 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:20:21,171 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,171 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 00:20:21,171 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,171 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 00:20:21,246 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,246 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:20:21,246 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,247 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:20:21,248 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,248 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:20:21,248 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,249 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:20:21,254 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,254 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:20:21,254 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,254 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:20:21,257 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,257 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 00:20:21,257 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,257 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 00:20:21,306 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,307 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,307 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,307 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:20:21,307 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,308 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,308 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,308 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:20:21,309 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,309 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,309 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,309 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:20:21,309 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,309 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,309 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,310 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:20:21,310 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,311 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,311 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,311 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,311 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,311 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,311 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,311 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,312 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,312 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,312 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,313 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,313 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,313 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,313 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,313 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,351 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,351 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,351 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,352 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:20:21,352 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,352 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,352 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,352 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:20:21,353 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,353 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,353 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,353 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:20:21,354 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,354 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,354 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,354 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:20:21,355 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,355 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,355 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,355 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,355 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,355 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,355 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,355 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,356 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,356 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,356 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,356 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,357 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,357 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,357 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,357 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,373 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,374 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,374 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,374 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,374 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,374 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,375 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,375 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,375 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,375 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,375 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,375 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,375 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,375 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,376 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,376 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,376 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,376 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,376 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,376 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:20:21,376 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,376 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,376 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,377 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:20:21,377 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,377 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,377 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,377 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:20:21,377 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,377 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,377 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,378 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:20:21,525 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,526 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:20:21,526 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,526 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:20:21,528 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,528 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:20:21,528 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,528 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:20:21,531 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,531 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,531 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,531 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:20:21,531 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,532 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,532 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,532 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:20:21,534 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,534 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,534 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,534 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:20:21,535 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,535 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,535 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,535 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:20:21,536 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,536 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:20:21,536 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,536 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:20:21,538 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,538 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,538 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,538 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,539 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,539 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,539 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,539 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,540 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,540 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 00:20:21,540 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,540 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 00:20:21,542 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,542 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,542 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,542 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,542 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,543 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,543 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,543 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,587 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,587 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:20:21,587 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,588 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:20:21,589 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,589 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:20:21,590 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,590 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:20:21,591 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,592 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,592 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,592 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:20:21,592 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,592 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,592 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,593 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:20:21,594 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,594 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,594 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,594 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:20:21,595 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,595 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,595 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,595 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:20:21,596 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,596 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:20:21,596 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,596 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:20:21,597 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,598 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,598 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,598 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,598 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,598 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,598 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,599 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,599 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,599 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 00:20:21,599 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,599 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 00:20:21,600 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,601 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,601 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,601 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,601 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,601 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,601 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,601 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,645 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,645 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:20:21,645 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,645 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:20:21,647 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,648 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:20:21,648 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,648 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:20:21,649 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,650 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,650 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,650 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:20:21,650 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,650 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,650 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,650 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:20:21,652 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,652 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,652 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,652 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:20:21,652 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,652 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,653 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,653 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:20:21,654 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,654 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:20:21,654 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,654 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:20:21,655 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,655 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,655 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,655 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,656 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,656 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,656 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,656 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,656 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,657 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 00:20:21,657 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,657 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 00:20:21,658 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,658 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,658 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,658 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,658 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,659 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,659 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,659 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,704 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,704 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:20:21,704 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,704 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:20:21,705 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,706 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:20:21,706 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,706 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:20:21,707 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,708 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,708 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,708 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:20:21,708 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,708 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,709 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,709 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:20:21,710 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,710 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,710 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,710 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:20:21,711 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,711 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,711 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,711 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:20:21,712 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,712 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:20:21,712 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,712 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:20:21,713 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,713 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,713 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,713 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,714 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,714 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,714 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,714 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,714 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,714 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 00:20:21,715 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,715 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 00:20:21,716 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,716 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,716 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,716 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,716 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,716 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,716 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,717 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,760 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,760 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:20:21,760 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,760 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:20:21,761 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,761 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:20:21,761 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,762 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:20:21,763 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,763 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,763 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,763 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:20:21,764 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,764 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,764 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,764 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:20:21,765 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,765 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,766 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,766 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:20:21,766 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,766 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:20:21,766 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,766 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:20:21,767 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,767 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:20:21,767 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,767 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:20:21,768 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,769 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,769 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,769 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,769 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,769 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,769 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,769 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,770 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:20:21,770 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 00:20:21,770 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,770 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 00:20:21,771 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,771 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,771 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,771 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:20:21,772 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:20:21,772 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:20:21,772 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:20:21,772 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:20:58,767 - __main__ - INFO -         using specific model
2017-05-08 00:20:58,767 - models - INFO -         Preparing data
2017-05-08 00:20:58,874 - models - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-08 00:20:58,874 - models - INFO -         50000train samples
2017-05-08 00:20:58,874 - models - INFO -         10000test samples
2017-05-08 00:20:59,182 - models - INFO -         create model 5 alexnet...
2017-05-08 00:21:00,338 - models - INFO -         fit model...
2017-05-08 00:21:00,697 - theano.gof.opt - ERROR -         SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x7f555861e7b8>
2017-05-08 00:21:00,697 - theano.gof.opt - ERROR -         Traceback:
2017-05-08 00:21:00,698 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 235, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 83, in optimize
    self.add_requirements(fgraph)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1482, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/fg.py", line 541, in attach_feature
    attach(self)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1299, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1362, in on_import
    self.set_shape(r, s)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1151, in set_shape
    shape_vars.append(self.unpack(s[i], r))
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1073, in unpack
    raise ValueError(msg)
ValueError: There is a negative shape in the graph! 
Backtrace when that variable is created:

  File "/home/kotus/Experiment/code/arch_comp.py", line 26, in main
    models.run(int(arg))
  File "/home/kotus/Experiment/code/models.py", line 249, in run
    _choose_model(arg)
  File "/home/kotus/Experiment/code/models.py", line 244, in _choose_model
    return args[arg]()
  File "/home/kotus/Experiment/code/models.py", line 183, in _create_model_5
    _model.add(Convolution2D(192, (3, 3)))
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/models.py", line 463, in add
    output_tensor = layer(self.outputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 578, in __call__
    output = self.call(inputs, **kwargs)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/layers/convolutional.py", line 164, in call
    dilation_rate=self.dilation_rate)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/backend/theano_backend.py", line 1769, in conv2d
    filter_dilation=dilation_rate)


2017-05-08 00:21:00,812 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:00,812 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:21:00,812 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:00,813 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:21:00,815 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:00,815 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:21:00,815 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:00,815 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:21:00,824 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:00,824 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:21:00,825 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:00,825 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:21:00,830 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:00,830 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,3,1,2}.0)
2017-05-08 00:21:00,830 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:00,830 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,3,1,2}.0

2017-05-08 00:21:00,966 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:00,966 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:21:00,966 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:00,966 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:21:00,968 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:00,968 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:21:00,968 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:00,968 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:21:00,976 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:00,976 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:21:00,976 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:00,976 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:21:00,979 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:00,980 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 00:21:00,980 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:00,980 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 00:21:01,054 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:01,054 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:21:01,054 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,054 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:21:01,056 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:01,057 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:21:01,057 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,057 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:21:01,062 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:01,063 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:21:01,063 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,063 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:21:01,065 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:01,065 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 00:21:01,065 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,066 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 00:21:01,115 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,115 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,115 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,116 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:21:01,116 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,116 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,116 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,116 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:21:01,117 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,117 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,117 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,117 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:21:01,117 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,118 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,118 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,118 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:21:01,119 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,119 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,119 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,119 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,119 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,119 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,119 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,120 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,120 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,120 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,121 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,121 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,121 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,121 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,121 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,121 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,158 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,159 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,159 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,159 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:21:01,159 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,159 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,159 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,160 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:21:01,160 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,160 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,161 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,161 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:21:01,161 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,161 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,161 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,161 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:21:01,162 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,162 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,162 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,163 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,163 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,163 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,163 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,163 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,164 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,164 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,164 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,164 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,164 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,164 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,164 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,165 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,182 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,182 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,182 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,182 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,182 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,182 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,183 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,183 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,183 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,183 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,183 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,183 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,183 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,183 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,184 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,184 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,184 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,184 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,184 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,184 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:21:01,184 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,184 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,185 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,185 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:21:01,185 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,185 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,185 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,185 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:21:01,185 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,185 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,185 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,186 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:21:01,331 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:01,331 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:21:01,332 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,332 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:21:01,333 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:01,333 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:21:01,333 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,334 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:21:01,336 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,336 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,337 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,337 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:21:01,337 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,337 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,337 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,337 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:21:01,340 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,340 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,340 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,340 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:21:01,340 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,341 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,341 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,341 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:21:01,342 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:01,342 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:21:01,342 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,342 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:21:01,344 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,344 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,344 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,345 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,345 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,345 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,345 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,345 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,346 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:01,346 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 00:21:01,346 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,346 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 00:21:01,348 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,348 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,348 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,348 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,348 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,349 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,349 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,349 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,393 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:01,393 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:21:01,393 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,394 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:21:01,395 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:01,395 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:21:01,396 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,396 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:21:01,397 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,397 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,397 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,397 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:21:01,398 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,398 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,398 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,398 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:21:01,399 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,399 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,400 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,400 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:21:01,400 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,400 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,400 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,400 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:21:01,401 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:01,401 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:21:01,401 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,401 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:21:01,402 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,403 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,403 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,403 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,403 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,403 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,403 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,403 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,404 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:01,404 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 00:21:01,404 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,404 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 00:21:01,405 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,405 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,405 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,406 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,406 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,406 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,406 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,406 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,449 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:01,450 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:21:01,450 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,450 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:21:01,452 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:01,452 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:21:01,452 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,452 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:21:01,454 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,454 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,454 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,454 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:21:01,454 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,455 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,455 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,455 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:21:01,456 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,456 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,456 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,457 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:21:01,457 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,457 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,457 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,457 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:21:01,458 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:01,458 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:21:01,458 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,458 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:21:01,459 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,460 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,460 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,460 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,460 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,460 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,460 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,460 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,461 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:01,461 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 00:21:01,461 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,461 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 00:21:01,462 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,462 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,462 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,462 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,463 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,463 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,463 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,463 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,508 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:01,508 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:21:01,508 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,508 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:21:01,510 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:01,510 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:21:01,510 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,510 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:21:01,511 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,512 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,512 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,512 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:21:01,512 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,512 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,512 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,513 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:21:01,514 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,514 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,514 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,514 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:21:01,514 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,514 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,514 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,515 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:21:01,515 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:01,516 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:21:01,516 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,516 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:21:01,517 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,517 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,517 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,517 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,517 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,517 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,517 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,518 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,518 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:01,518 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 00:21:01,518 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,519 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 00:21:01,520 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,520 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,520 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,520 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,520 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,520 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,520 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,520 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,562 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:01,562 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:21:01,562 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,562 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:21:01,564 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:01,564 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:21:01,564 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,564 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:21:01,565 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,565 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,566 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,566 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:21:01,566 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,566 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,566 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,566 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:21:01,568 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,568 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,568 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,568 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:21:01,568 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,568 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:21:01,569 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,569 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:21:01,569 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:01,570 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:21:01,570 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,570 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:21:01,571 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,571 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,571 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,571 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,572 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,572 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,572 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,572 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,572 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:01,573 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 00:21:01,573 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,573 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 00:21:01,574 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,574 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,574 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,574 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:21:01,574 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:21:01,574 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:21:01,574 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:01,575 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:21:06,883 - theano.gof.opt - ERROR -         SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x7f555861e7b8>
2017-05-08 00:21:06,884 - theano.gof.opt - ERROR -         Traceback:
2017-05-08 00:21:06,884 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 235, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 83, in optimize
    self.add_requirements(fgraph)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1482, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/fg.py", line 541, in attach_feature
    attach(self)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1299, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1362, in on_import
    self.set_shape(r, s)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1151, in set_shape
    shape_vars.append(self.unpack(s[i], r))
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1073, in unpack
    raise ValueError(msg)
ValueError: There is a negative shape in the graph! 
Backtrace when that variable is created:

  File "/home/kotus/Experiment/code/arch_comp.py", line 26, in main
    models.run(int(arg))
  File "/home/kotus/Experiment/code/models.py", line 249, in run
    _choose_model(arg)
  File "/home/kotus/Experiment/code/models.py", line 244, in _choose_model
    return args[arg]()
  File "/home/kotus/Experiment/code/models.py", line 183, in _create_model_5
    _model.add(Convolution2D(192, (3, 3)))
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/models.py", line 463, in add
    output_tensor = layer(self.outputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 578, in __call__
    output = self.call(inputs, **kwargs)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/layers/convolutional.py", line 164, in call
    dilation_rate=self.dilation_rate)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/backend/theano_backend.py", line 1769, in conv2d
    filter_dilation=dilation_rate)


2017-05-08 00:21:06,893 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:06,893 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:21:06,894 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:06,894 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:21:06,896 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:06,897 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:21:06,897 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:06,897 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:21:06,899 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:06,900 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:21:06,900 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:06,900 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:21:06,921 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:06,921 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:21:06,921 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:06,922 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:21:06,923 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:06,923 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:21:06,923 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:06,923 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:21:06,927 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:06,927 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:21:06,927 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:06,927 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:21:06,934 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:06,934 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:21:06,934 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:06,935 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:21:06,936 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:06,936 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:21:06,936 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:06,936 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:21:06,939 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:06,939 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:21:06,939 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:06,939 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:21:06,977 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:06,978 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:21:06,978 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:06,978 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:21:06,980 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:06,980 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:21:06,980 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:06,980 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:21:06,982 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:06,982 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:21:06,982 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:06,982 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:21:06,988 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:06,988 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:21:06,989 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:06,989 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:21:06,990 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:06,990 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:21:06,990 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:06,990 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:21:06,992 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:06,992 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:21:06,992 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:06,992 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:21:06,999 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:07,000 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:21:07,000 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:07,000 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:21:07,002 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:07,002 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:21:07,002 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:07,002 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:21:07,003 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:07,003 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:21:07,004 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:07,004 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:21:07,011 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:07,011 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:21:07,011 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:07,012 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:21:07,012 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:07,013 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:21:07,013 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:07,013 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:21:07,014 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:07,014 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:21:07,014 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:07,015 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:21:07,021 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:07,021 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:21:07,021 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:07,021 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:21:07,022 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:07,022 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:21:07,022 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:07,022 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:21:07,023 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:21:07,024 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:21:07,024 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:21:07,024 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:23:22,226 - __main__ - INFO -         using specific model
2017-05-08 00:23:22,226 - models - INFO -         Preparing data
2017-05-08 00:23:22,332 - models - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-08 00:23:22,333 - models - INFO -         50000train samples
2017-05-08 00:23:22,333 - models - INFO -         10000test samples
2017-05-08 00:23:22,637 - models - INFO -         create model 5 alexnet...
2017-05-08 00:23:23,795 - models - INFO -         fit model...
2017-05-08 00:23:24,147 - theano.gof.opt - ERROR -         SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x7fd1f1c80748>
2017-05-08 00:23:24,147 - theano.gof.opt - ERROR -         Traceback:
2017-05-08 00:23:24,148 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 235, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 83, in optimize
    self.add_requirements(fgraph)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1482, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/fg.py", line 541, in attach_feature
    attach(self)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1299, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1362, in on_import
    self.set_shape(r, s)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1151, in set_shape
    shape_vars.append(self.unpack(s[i], r))
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1073, in unpack
    raise ValueError(msg)
ValueError: There is a negative shape in the graph! 
Backtrace when that variable is created:

  File "/home/kotus/Experiment/code/arch_comp.py", line 26, in main
    models.run(int(arg))
  File "/home/kotus/Experiment/code/models.py", line 249, in run
    _choose_model(arg)
  File "/home/kotus/Experiment/code/models.py", line 244, in _choose_model
    return args[arg]()
  File "/home/kotus/Experiment/code/models.py", line 183, in _create_model_5
    _model.add(Convolution2D(128, (3, 3)))
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/models.py", line 463, in add
    output_tensor = layer(self.outputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 578, in __call__
    output = self.call(inputs, **kwargs)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/layers/convolutional.py", line 164, in call
    dilation_rate=self.dilation_rate)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/backend/theano_backend.py", line 1769, in conv2d
    filter_dilation=dilation_rate)


2017-05-08 00:23:24,262 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:24,263 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:23:24,263 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,263 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:23:24,265 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:24,266 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:23:24,266 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,266 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:23:24,274 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:24,275 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:23:24,275 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,275 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:23:24,280 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:24,280 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,3,1,2}.0)
2017-05-08 00:23:24,280 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,280 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,3,1,2}.0

2017-05-08 00:23:24,418 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:24,418 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:23:24,418 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,419 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:23:24,420 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:24,421 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:23:24,421 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,421 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:23:24,428 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:24,428 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:23:24,428 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,428 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:23:24,431 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:24,432 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 00:23:24,432 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,432 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 00:23:24,507 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:24,507 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:23:24,507 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,507 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:23:24,509 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:24,509 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:23:24,509 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,510 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:23:24,515 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:24,515 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:23:24,515 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,515 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:23:24,518 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:24,518 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 00:23:24,518 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,518 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 00:23:24,567 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,567 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:24,567 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,567 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:23:24,568 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,568 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:24,568 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,568 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:23:24,569 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,569 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:24,569 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,569 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:23:24,569 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,569 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:24,569 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,570 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:23:24,570 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,571 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:24,571 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,571 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:23:24,571 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,571 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:24,571 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,571 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:23:24,572 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,572 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:24,572 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,572 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:23:24,573 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,573 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:24,573 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,573 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:23:24,609 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,609 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:24,609 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,610 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:23:24,610 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,610 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:24,610 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,610 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:23:24,611 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,611 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:24,611 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,611 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:23:24,612 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,612 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:24,612 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,612 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:23:24,613 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,613 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:24,613 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,613 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:23:24,613 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,613 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:24,613 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,613 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:23:24,614 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,614 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:24,614 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,614 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:23:24,615 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,615 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:24,615 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,615 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:23:24,631 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,631 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:24,632 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,632 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:23:24,632 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,632 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:24,632 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,632 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:23:24,633 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,633 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:24,633 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,633 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:23:24,633 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,633 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:24,633 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,633 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:23:24,634 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,634 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:24,634 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,634 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:23:24,634 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,634 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:24,634 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,634 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:23:24,635 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,635 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:24,635 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,635 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:23:24,635 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,635 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:24,635 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,635 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:23:24,779 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:24,779 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:23:24,779 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,780 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:23:24,781 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:24,781 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:23:24,781 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,781 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:23:24,784 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,784 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:24,784 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,785 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:23:24,785 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,785 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:24,785 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,785 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:23:24,787 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,787 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:24,787 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,787 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:23:24,788 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,788 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:24,788 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,788 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:23:24,789 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:24,789 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:23:24,789 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,789 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:23:24,791 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,791 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:24,791 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,791 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:23:24,792 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,792 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:24,792 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,792 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:23:24,792 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:24,792 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 00:23:24,793 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,793 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 00:23:24,794 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,795 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:24,795 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,795 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:23:24,795 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,795 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:24,795 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,795 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:23:24,838 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:24,839 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:23:24,839 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,839 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:23:24,840 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:24,841 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:23:24,841 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,841 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:23:24,842 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,842 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:24,842 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,843 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:23:24,843 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,843 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:24,843 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,843 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:23:24,844 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,844 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:24,845 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,845 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:23:24,845 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,845 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:24,845 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,845 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:23:24,846 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:24,846 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:23:24,846 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,846 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:23:24,847 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,847 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:24,848 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,848 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:23:24,848 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,848 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:24,848 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,848 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:23:24,849 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:24,849 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 00:23:24,849 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,849 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 00:23:24,850 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,850 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:24,850 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,850 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:23:24,851 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,851 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:24,851 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,851 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:23:24,893 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:24,893 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:23:24,894 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,894 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:23:24,896 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:24,896 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:23:24,896 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,896 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:23:24,897 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,897 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:24,897 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,898 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:23:24,898 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,898 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:24,898 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,898 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:23:24,899 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,900 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:24,900 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,900 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:23:24,900 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,900 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:24,900 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,900 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:23:24,901 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:24,901 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:23:24,901 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,901 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:23:24,902 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,902 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:24,903 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,903 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:23:24,903 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,903 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:24,903 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,903 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:23:24,904 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:24,904 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 00:23:24,904 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,904 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 00:23:24,905 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,905 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:24,905 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,905 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:23:24,906 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,906 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:24,906 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,906 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:23:24,948 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:24,949 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:23:24,949 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,949 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:23:24,950 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:24,950 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:23:24,950 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,951 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:23:24,952 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,952 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:24,952 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,953 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:23:24,953 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,953 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:24,953 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,953 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:23:24,954 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,955 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:24,955 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,955 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:23:24,955 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,955 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:24,955 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,955 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:23:24,956 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:24,956 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:23:24,956 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,957 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:23:24,958 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,958 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:24,958 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,958 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:23:24,958 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,958 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:24,958 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,958 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:23:24,959 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:24,959 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 00:23:24,959 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,959 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 00:23:24,960 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,960 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:24,961 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,961 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:23:24,961 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:24,961 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:24,961 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:24,961 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:23:25,003 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:25,003 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:23:25,003 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:25,003 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:23:25,004 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:25,004 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:23:25,005 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:25,005 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:23:25,006 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:25,006 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:25,006 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:25,006 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:23:25,006 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:25,007 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:25,007 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:25,007 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:23:25,008 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:25,008 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:25,008 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:25,009 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 00:23:25,009 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:25,009 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 00:23:25,009 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:25,009 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 00:23:25,010 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:25,010 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:23:25,010 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:25,010 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:23:25,011 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:25,011 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:25,012 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:25,012 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:23:25,012 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:25,012 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:25,012 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:25,012 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:23:25,013 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:25,013 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 00:23:25,013 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:25,013 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 00:23:25,014 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:25,014 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:25,014 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:25,014 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 00:23:25,014 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 00:23:25,015 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 00:23:25,015 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:25,015 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 00:23:27,240 - theano.gof.opt - ERROR -         SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x7fd1f1c80748>
2017-05-08 00:23:27,241 - theano.gof.opt - ERROR -         Traceback:
2017-05-08 00:23:27,241 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 235, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 83, in optimize
    self.add_requirements(fgraph)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1482, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/fg.py", line 541, in attach_feature
    attach(self)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1299, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1362, in on_import
    self.set_shape(r, s)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1151, in set_shape
    shape_vars.append(self.unpack(s[i], r))
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1073, in unpack
    raise ValueError(msg)
ValueError: There is a negative shape in the graph! 
Backtrace when that variable is created:

  File "/home/kotus/Experiment/code/arch_comp.py", line 26, in main
    models.run(int(arg))
  File "/home/kotus/Experiment/code/models.py", line 249, in run
    _choose_model(arg)
  File "/home/kotus/Experiment/code/models.py", line 244, in _choose_model
    return args[arg]()
  File "/home/kotus/Experiment/code/models.py", line 183, in _create_model_5
    _model.add(Convolution2D(128, (3, 3)))
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/models.py", line 463, in add
    output_tensor = layer(self.outputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 578, in __call__
    output = self.call(inputs, **kwargs)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/layers/convolutional.py", line 164, in call
    dilation_rate=self.dilation_rate)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/backend/theano_backend.py", line 1769, in conv2d
    filter_dilation=dilation_rate)


2017-05-08 00:23:27,249 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:27,250 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:23:27,250 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:27,250 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:23:27,253 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:27,253 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:23:27,253 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:27,253 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:23:27,256 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:27,256 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:23:27,256 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:27,256 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:23:27,277 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:27,277 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:23:27,277 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:27,277 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:23:27,279 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:27,279 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:23:27,279 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:27,279 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:23:27,282 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:27,282 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:23:27,282 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:27,282 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:23:27,290 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:27,290 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:23:27,290 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:27,290 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:23:27,292 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:27,292 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:23:27,292 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:27,292 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:23:27,294 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:27,295 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:23:27,295 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:27,295 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:23:27,334 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:27,334 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:23:27,334 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:27,334 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:23:27,335 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:27,336 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:23:27,336 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:27,336 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:23:27,337 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:27,338 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:23:27,338 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:27,338 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:23:27,344 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:27,344 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:23:27,344 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:27,344 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:23:27,346 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:27,346 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:23:27,346 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:27,346 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:23:27,348 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:27,348 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:23:27,348 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:27,348 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:23:27,355 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:27,355 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:23:27,355 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:27,356 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:23:27,357 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:27,357 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:23:27,357 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:27,358 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:23:27,359 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:27,359 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:23:27,359 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:27,359 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:23:27,367 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:27,367 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:23:27,367 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:27,367 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:23:27,368 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:27,368 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:23:27,368 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:27,368 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:23:27,370 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:27,370 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:23:27,370 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:27,370 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:23:27,377 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:27,377 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 00:23:27,377 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:27,377 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 00:23:27,378 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:27,378 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 00:23:27,379 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:27,379 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 00:23:27,380 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 00:23:27,380 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 00:23:27,380 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 00:23:27,380 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 00:25:33,771 - __main__ - INFO -         using specific model
2017-05-08 00:25:33,772 - models - INFO -         Preparing data
2017-05-08 00:25:33,878 - models - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-08 00:25:33,878 - models - INFO -         50000train samples
2017-05-08 00:25:33,879 - models - INFO -         10000test samples
2017-05-08 00:25:34,183 - models - INFO -         create model 5 alexnet...
2017-05-08 00:27:13,371 - __main__ - INFO -         using specific model
2017-05-08 00:27:13,371 - models - INFO -         Preparing data
2017-05-08 00:27:13,481 - models - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-08 00:27:13,481 - models - INFO -         50000train samples
2017-05-08 00:27:13,482 - models - INFO -         10000test samples
2017-05-08 00:27:13,792 - models - INFO -         create model 5 alexnet...
2017-05-08 08:51:26,295 - __main__ - INFO -         using specific model
2017-05-08 08:51:26,296 - models - INFO -         Preparing data
2017-05-08 08:51:26,392 - models - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-08 08:51:26,392 - models - INFO -         50000train samples
2017-05-08 08:51:26,392 - models - INFO -         10000test samples
2017-05-08 08:51:26,678 - models - INFO -         create model 5 alexnet...
2017-05-08 09:00:27,806 - __main__ - INFO -         using specific model
2017-05-08 09:00:27,806 - models - INFO -         Preparing data
2017-05-08 09:00:27,906 - models - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-08 09:00:27,906 - models - INFO -         50000train samples
2017-05-08 09:00:27,906 - models - INFO -         10000test samples
2017-05-08 09:00:28,210 - models - INFO -         create model 5 alexnet...
2017-05-08 09:02:00,549 - __main__ - INFO -         using specific model
2017-05-08 09:02:00,549 - models - INFO -         Preparing data
2017-05-08 09:02:00,649 - models - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-08 09:02:00,649 - models - INFO -         50000train samples
2017-05-08 09:02:00,649 - models - INFO -         10000test samples
2017-05-08 09:02:00,940 - models - INFO -         create model 5 alexnet...
2017-05-08 09:02:01,796 - models - INFO -         compiling model
2017-05-08 09:02:01,803 - models - INFO -         fit model...
2017-05-08 09:02:02,126 - theano.gof.opt - ERROR -         SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x7fd9aa6ea780>
2017-05-08 09:02:02,126 - theano.gof.opt - ERROR -         Traceback:
2017-05-08 09:02:02,127 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 235, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 83, in optimize
    self.add_requirements(fgraph)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1482, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/fg.py", line 541, in attach_feature
    attach(self)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1299, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1362, in on_import
    self.set_shape(r, s)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1151, in set_shape
    shape_vars.append(self.unpack(s[i], r))
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1073, in unpack
    raise ValueError(msg)
ValueError: There is a negative shape in the graph! 
Backtrace when that variable is created:

  File "/home/kotus/Experiment/code/arch_comp.py", line 26, in main
    models.run(int(arg))
  File "/home/kotus/Experiment/code/models.py", line 246, in run
    _choose_model(arg)
  File "/home/kotus/Experiment/code/models.py", line 241, in _choose_model
    return args[arg]()
  File "/home/kotus/Experiment/code/models.py", line 181, in _create_model_5
    _model.add(Convolution2D(64, (3, 3), activation='relu'))
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/models.py", line 463, in add
    output_tensor = layer(self.outputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 578, in __call__
    output = self.call(inputs, **kwargs)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/layers/convolutional.py", line 164, in call
    dilation_rate=self.dilation_rate)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/backend/theano_backend.py", line 1769, in conv2d
    filter_dilation=dilation_rate)


2017-05-08 09:02:02,232 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,232 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:02:02,232 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,233 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:02:02,235 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,235 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:02:02,235 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,235 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:02:02,243 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,243 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:02:02,243 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,244 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:02:02,247 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,247 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,3,1,2}.0)
2017-05-08 09:02:02,247 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,248 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,3,1,2}.0

2017-05-08 09:02:02,370 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,370 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:02:02,370 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,371 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:02:02,372 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,372 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:02:02,372 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,372 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:02:02,379 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,379 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:02:02,379 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,379 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:02:02,383 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,384 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 09:02:02,384 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,384 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 09:02:02,456 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,456 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:02:02,457 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,457 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:02:02,458 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,459 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:02:02,459 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,459 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:02:02,464 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,464 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:02:02,464 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,464 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:02:02,467 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,467 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 09:02:02,467 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,467 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 09:02:02,513 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,513 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,513 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,514 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:02:02,514 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,514 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,514 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,514 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:02:02,515 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,515 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,515 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,515 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:02:02,515 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,516 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,516 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,516 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:02:02,516 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,517 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,517 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,517 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,517 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,517 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,517 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,517 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,518 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,518 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,518 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,519 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,519 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,519 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,519 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,519 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,554 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,554 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,555 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,555 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:02:02,555 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,555 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,555 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,555 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:02:02,556 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,556 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,556 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,556 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:02:02,556 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,557 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,557 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,557 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:02:02,558 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,558 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,558 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,558 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,558 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,558 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,558 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,558 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,559 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,559 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,559 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,559 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,560 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,560 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,560 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,560 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,575 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,575 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,575 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,575 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,576 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,576 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,576 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,576 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,576 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,576 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,577 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,577 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,577 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,577 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,577 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,577 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,577 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,577 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,578 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,578 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:02:02,578 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,578 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,578 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,578 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:02:02,578 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,578 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,578 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,578 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:02:02,579 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,579 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,579 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,579 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:02:02,713 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,713 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:02:02,714 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,714 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:02:02,715 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,715 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:02:02,715 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,716 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:02:02,718 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,718 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,718 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,718 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:02:02,719 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,719 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,719 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,719 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:02:02,721 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,721 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,721 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,721 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:02:02,721 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,721 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,722 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,722 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:02:02,723 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,723 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:02:02,723 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,723 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:02:02,724 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,724 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,725 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,725 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,725 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,725 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,725 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,725 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,726 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,727 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 09:02:02,727 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,727 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 09:02:02,728 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,729 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,729 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,729 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,729 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,729 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,729 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,729 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,769 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,769 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:02:02,769 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,770 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:02:02,771 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,771 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:02:02,771 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,771 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:02:02,773 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,773 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,773 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,773 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:02:02,773 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,774 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,774 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,774 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:02:02,775 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,775 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,775 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,775 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:02:02,776 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,776 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,776 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,776 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:02:02,777 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,777 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:02:02,777 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,777 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:02:02,778 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,778 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,778 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,778 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,779 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,779 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,779 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,779 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,780 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,780 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 09:02:02,780 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,780 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 09:02:02,781 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,781 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,781 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,781 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,781 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,782 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,782 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,782 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,821 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,821 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:02:02,821 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,822 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:02:02,823 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,824 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:02:02,824 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,824 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:02:02,825 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,825 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,825 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,825 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:02:02,826 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,826 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,826 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,826 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:02:02,827 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,827 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,827 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,828 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:02:02,828 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,828 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,828 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,828 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:02:02,829 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,829 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:02:02,830 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,830 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:02:02,830 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,831 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,831 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,831 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,831 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,831 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,831 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,831 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,832 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,833 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 09:02:02,833 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,833 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 09:02:02,833 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,833 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,834 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,834 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,834 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,834 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,834 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,834 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,875 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,875 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:02:02,875 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,875 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:02:02,876 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,877 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:02:02,877 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,877 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:02:02,878 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,878 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,878 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,879 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:02:02,879 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,879 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,879 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,879 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:02:02,880 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,881 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,881 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,881 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:02:02,881 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,881 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,881 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,881 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:02:02,882 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,882 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:02:02,883 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,883 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:02:02,883 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,884 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,884 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,884 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,884 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,884 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,884 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,884 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,885 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,885 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 09:02:02,886 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,886 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 09:02:02,886 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,886 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,886 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,887 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,887 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,887 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,887 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,887 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,926 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,926 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:02:02,926 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,926 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:02:02,927 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,928 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:02:02,928 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,928 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:02:02,929 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,929 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,929 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,930 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:02:02,930 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,930 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,930 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,930 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:02:02,931 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,932 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,932 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,932 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:02:02,932 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,932 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:02:02,932 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,933 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:02:02,934 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,934 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:02:02,934 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,934 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:02:02,935 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,935 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,935 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,935 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,935 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,936 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,936 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,936 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,937 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:02,937 - theano.gof.opt - ERROR -         node: Shape(Pool{ignore_border=True, mode='max', ndim=2}.0)
2017-05-08 09:02:02,937 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,937 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Pool{ignore_border=True, mode='max', ndim=2}.0

2017-05-08 09:02:02,938 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,938 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,938 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,938 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 09:02:02,938 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:02:02,938 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:02:02,938 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:02,938 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 09:02:04,873 - theano.gof.opt - ERROR -         SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x7fd9aa6ea780>
2017-05-08 09:02:04,873 - theano.gof.opt - ERROR -         Traceback:
2017-05-08 09:02:04,874 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 235, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 83, in optimize
    self.add_requirements(fgraph)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1482, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/fg.py", line 541, in attach_feature
    attach(self)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1299, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1362, in on_import
    self.set_shape(r, s)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1151, in set_shape
    shape_vars.append(self.unpack(s[i], r))
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1073, in unpack
    raise ValueError(msg)
ValueError: There is a negative shape in the graph! 
Backtrace when that variable is created:

  File "/home/kotus/Experiment/code/arch_comp.py", line 26, in main
    models.run(int(arg))
  File "/home/kotus/Experiment/code/models.py", line 246, in run
    _choose_model(arg)
  File "/home/kotus/Experiment/code/models.py", line 241, in _choose_model
    return args[arg]()
  File "/home/kotus/Experiment/code/models.py", line 181, in _create_model_5
    _model.add(Convolution2D(64, (3, 3), activation='relu'))
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/models.py", line 463, in add
    output_tensor = layer(self.outputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 578, in __call__
    output = self.call(inputs, **kwargs)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/layers/convolutional.py", line 164, in call
    dilation_rate=self.dilation_rate)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/backend/theano_backend.py", line 1769, in conv2d
    filter_dilation=dilation_rate)


2017-05-08 09:02:04,882 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:04,882 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:02:04,882 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:04,882 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:02:04,885 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:04,885 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:02:04,885 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:04,885 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:02:04,888 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:04,888 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:02:04,888 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:04,888 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:02:04,905 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:04,905 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:02:04,905 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:04,905 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:02:04,907 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:04,907 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:02:04,907 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:04,907 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:02:04,910 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:04,910 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:02:04,911 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:04,911 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:02:04,917 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:04,917 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:02:04,917 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:04,918 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:02:04,919 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:04,919 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:02:04,919 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:04,919 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:02:04,922 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:04,922 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:02:04,922 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:04,922 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:02:04,958 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:04,959 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:02:04,959 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:04,959 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:02:04,960 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:04,960 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:02:04,960 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:04,961 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:02:04,962 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:04,962 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:02:04,963 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:04,963 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:02:04,968 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:04,969 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:02:04,969 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:04,969 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:02:04,970 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:04,970 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:02:04,970 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:04,971 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:02:04,972 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:04,972 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:02:04,972 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:04,972 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:02:04,979 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:04,979 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:02:04,979 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:04,979 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:02:04,981 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:04,981 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:02:04,981 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:04,981 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:02:04,982 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:04,982 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:02:04,982 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:04,983 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:02:04,990 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:04,990 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:02:04,990 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:04,990 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:02:04,991 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:04,991 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:02:04,991 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:04,991 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:02:04,993 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:04,993 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:02:04,993 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:04,993 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:02:04,999 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:04,999 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:02:04,999 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:04,999 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:02:05,000 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:05,000 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:02:05,000 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:05,000 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:02:05,002 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:02:05,002 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:02:05,002 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:02:05,002 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:03:19,437 - __main__ - INFO -         using specific model
2017-05-08 09:03:19,437 - models - INFO -         Preparing data
2017-05-08 09:03:19,534 - models - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-08 09:03:19,534 - models - INFO -         50000train samples
2017-05-08 09:03:19,535 - models - INFO -         10000test samples
2017-05-08 09:03:19,819 - models - INFO -         create model 5 alexnet...
2017-05-08 09:03:20,735 - models - INFO -         compiling model
2017-05-08 09:03:20,741 - models - INFO -         fit model...
2017-05-08 09:03:21,070 - theano.gof.opt - ERROR -         SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x7f209de54780>
2017-05-08 09:03:21,070 - theano.gof.opt - ERROR -         Traceback:
2017-05-08 09:03:21,071 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 235, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 83, in optimize
    self.add_requirements(fgraph)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1482, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/fg.py", line 541, in attach_feature
    attach(self)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1299, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1362, in on_import
    self.set_shape(r, s)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1151, in set_shape
    shape_vars.append(self.unpack(s[i], r))
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1073, in unpack
    raise ValueError(msg)
ValueError: There is a negative shape in the graph! 
Backtrace when that variable is created:

  File "/home/kotus/Experiment/code/arch_comp.py", line 26, in main
    models.run(int(arg))
  File "/home/kotus/Experiment/code/models.py", line 246, in run
    _choose_model(arg)
  File "/home/kotus/Experiment/code/models.py", line 241, in _choose_model
    return args[arg]()
  File "/home/kotus/Experiment/code/models.py", line 185, in _create_model_5
    _model.add(Convolution2D(64, (3, 3), activation='relu'))
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/models.py", line 463, in add
    output_tensor = layer(self.outputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 578, in __call__
    output = self.call(inputs, **kwargs)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/layers/convolutional.py", line 164, in call
    dilation_rate=self.dilation_rate)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/backend/theano_backend.py", line 1769, in conv2d
    filter_dilation=dilation_rate)


2017-05-08 09:03:21,177 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:21,177 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:03:21,177 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,177 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:03:21,179 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:21,180 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:03:21,180 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,180 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:03:21,188 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:21,188 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:03:21,188 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,188 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:03:21,323 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:21,323 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:03:21,323 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,324 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:03:21,325 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:21,325 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:03:21,325 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,326 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:03:21,332 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:21,332 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:03:21,332 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,332 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:03:21,407 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:21,407 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:03:21,407 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,407 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:03:21,409 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:21,409 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:03:21,409 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,410 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:03:21,415 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:21,415 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:03:21,415 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,416 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:03:21,464 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,464 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,465 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,465 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:03:21,465 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,465 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,465 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,465 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:03:21,466 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,466 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,466 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,466 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:03:21,467 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,467 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,467 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,467 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:03:21,468 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,468 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:03:21,468 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,468 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 09:03:21,468 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,468 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:03:21,468 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,469 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 09:03:21,506 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,506 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,506 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,507 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:03:21,507 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,507 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,507 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,507 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:03:21,508 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,508 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,508 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,508 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:03:21,509 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,509 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,509 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,509 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:03:21,510 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,510 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:03:21,510 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,510 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 09:03:21,510 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,510 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:03:21,510 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,510 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 09:03:21,527 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,528 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:03:21,528 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,528 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 09:03:21,528 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,528 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:03:21,528 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,529 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 09:03:21,529 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,529 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,529 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,529 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:03:21,529 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,529 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,530 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,530 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:03:21,530 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,530 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,530 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,530 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:03:21,530 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,530 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,530 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,531 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:03:21,664 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:21,664 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:03:21,664 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,665 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:03:21,666 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:21,666 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:03:21,666 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,666 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:03:21,669 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,669 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,669 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,669 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:03:21,669 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,669 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,669 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,670 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:03:21,671 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,671 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,672 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,672 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:03:21,672 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,672 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,672 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,672 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:03:21,673 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:21,673 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:03:21,673 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,674 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:03:21,675 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,675 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:03:21,675 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,675 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 09:03:21,675 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,675 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:03:21,675 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,676 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 09:03:21,719 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:21,719 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:03:21,719 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,719 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:03:21,721 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:21,721 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:03:21,721 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,721 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:03:21,722 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,723 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,723 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,723 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:03:21,723 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,723 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,723 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,724 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:03:21,725 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,725 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,725 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,725 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:03:21,725 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,726 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,726 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,726 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:03:21,727 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:21,727 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:03:21,727 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,727 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:03:21,728 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,728 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:03:21,728 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,729 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 09:03:21,729 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,729 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:03:21,729 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,729 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 09:03:21,771 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:21,771 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:03:21,771 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,771 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:03:21,773 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:21,773 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:03:21,774 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,774 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:03:21,775 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,775 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,775 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,775 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:03:21,776 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,776 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,776 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,776 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:03:21,777 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,777 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,777 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,777 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:03:21,778 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,778 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,778 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,778 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:03:21,779 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:21,779 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:03:21,779 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,779 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:03:21,780 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,780 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:03:21,780 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,780 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 09:03:21,781 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,781 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:03:21,781 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,781 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 09:03:21,823 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:21,824 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:03:21,824 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,824 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:03:21,825 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:21,825 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:03:21,825 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,826 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:03:21,827 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,827 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,827 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,827 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:03:21,827 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,828 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,828 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,828 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:03:21,829 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,829 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,830 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,830 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:03:21,830 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,830 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,830 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,830 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:03:21,831 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:21,832 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:03:21,832 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,832 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:03:21,832 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,833 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:03:21,833 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,833 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 09:03:21,833 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,833 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:03:21,833 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,833 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 09:03:21,874 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:21,874 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:03:21,874 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,875 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:03:21,876 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:21,876 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:03:21,876 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,876 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:03:21,878 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,878 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,878 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,878 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:03:21,878 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,878 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,878 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,879 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:03:21,880 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,880 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,880 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,880 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0,)}.0

2017-05-08 09:03:21,881 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,881 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0,)}.0, TensorConstant{(1, 1) of 0.0})
2017-05-08 09:03:21,881 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,881 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0,)}.0

2017-05-08 09:03:21,882 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:21,882 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:03:21,882 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,882 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:03:21,883 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,883 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormTrain{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:03:21,883 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,883 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormTrain{axes=(0, 1, 2)}.0

2017-05-08 09:03:21,883 - theano.gof.opt - ERROR -         Optimization failure due to: local_fill_to_alloc
2017-05-08 09:03:21,884 - theano.gof.opt - ERROR -         node: Elemwise{second,no_inplace}(AbstractBatchNormInference{axes=(0, 1, 2)}.0, TensorConstant{(1, 1, 1, 1) of 0.0})
2017-05-08 09:03:21,884 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:21,884 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1725, in local_fill_to_alloc
    o = broadcast_like(v, r, node.fgraph, dtype=v.dtype)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 130, in broadcast_like
    new_shape = fgraph.shape_feature.shape_of[template]
KeyError: AbstractBatchNormInference{axes=(0, 1, 2)}.0

2017-05-08 09:03:24,228 - theano.gof.opt - ERROR -         SeqOptimizer apply <theano.tensor.opt.ShapeOptimizer object at 0x7f209de54780>
2017-05-08 09:03:24,228 - theano.gof.opt - ERROR -         Traceback:
2017-05-08 09:03:24,228 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 235, in apply
    sub_prof = optimizer.optimize(fgraph)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 83, in optimize
    self.add_requirements(fgraph)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1482, in add_requirements
    fgraph.attach_feature(ShapeFeature())
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/fg.py", line 541, in attach_feature
    attach(self)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1299, in on_attach
    self.on_import(fgraph, node, reason='on_attach')
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1362, in on_import
    self.set_shape(r, s)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1151, in set_shape
    shape_vars.append(self.unpack(s[i], r))
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1073, in unpack
    raise ValueError(msg)
ValueError: There is a negative shape in the graph! 
Backtrace when that variable is created:

  File "/home/kotus/Experiment/code/arch_comp.py", line 26, in main
    models.run(int(arg))
  File "/home/kotus/Experiment/code/models.py", line 246, in run
    _choose_model(arg)
  File "/home/kotus/Experiment/code/models.py", line 241, in _choose_model
    return args[arg]()
  File "/home/kotus/Experiment/code/models.py", line 185, in _create_model_5
    _model.add(Convolution2D(64, (3, 3), activation='relu'))
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/models.py", line 463, in add
    output_tensor = layer(self.outputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/engine/topology.py", line 578, in __call__
    output = self.call(inputs, **kwargs)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/layers/convolutional.py", line 164, in call
    dilation_rate=self.dilation_rate)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/keras/backend/theano_backend.py", line 1769, in conv2d
    filter_dilation=dilation_rate)


2017-05-08 09:03:24,237 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:24,237 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:03:24,237 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:24,237 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:03:24,240 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:24,240 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:03:24,240 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:24,240 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:03:24,243 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:24,243 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:03:24,243 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:24,243 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:03:24,259 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:24,260 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:03:24,260 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:24,260 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:03:24,261 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:24,261 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:03:24,261 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:24,262 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:03:24,264 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:24,264 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:03:24,264 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:24,265 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:03:24,271 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:24,271 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:03:24,271 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:24,271 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:03:24,273 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:24,273 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:03:24,273 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:24,274 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:03:24,276 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:24,276 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:03:24,276 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:24,276 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:03:24,404 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:24,404 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:03:24,405 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:24,405 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:03:24,406 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:24,406 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:03:24,406 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:24,406 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:03:24,408 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:24,408 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:03:24,408 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:24,409 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:03:24,414 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:24,414 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:03:24,414 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:24,415 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:03:24,416 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:24,416 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:03:24,416 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:24,417 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:03:24,418 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:24,418 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:03:24,418 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:24,418 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:03:24,425 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:24,425 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:03:24,425 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:24,426 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:03:24,427 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:24,427 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:03:24,427 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:24,427 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:03:24,429 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:24,429 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:03:24,429 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:24,429 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:03:24,436 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:24,436 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:03:24,437 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:24,437 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:03:24,438 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:24,438 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:03:24,438 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:24,438 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:03:24,439 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:24,440 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:03:24,440 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:24,440 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:03:24,446 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:24,446 - theano.gof.opt - ERROR -         node: Shape(Elemwise{true_div,no_inplace}.0)
2017-05-08 09:03:24,446 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:24,446 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{true_div,no_inplace}.0

2017-05-08 09:03:24,447 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:24,447 - theano.gof.opt - ERROR -         node: Shape(Elemwise{Cast{float32}}.0)
2017-05-08 09:03:24,447 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:24,447 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: Elemwise{Cast{float32}}.0

2017-05-08 09:03:24,448 - theano.gof.opt - ERROR -         Optimization failure due to: local_shape_to_shape_i
2017-05-08 09:03:24,448 - theano.gof.opt - ERROR -         node: Shape(InplaceDimShuffle{0,2,3,1}.0)
2017-05-08 09:03:24,449 - theano.gof.opt - ERROR -         TRACEBACK:
2017-05-08 09:03:24,449 - theano.gof.opt - ERROR -         Traceback (most recent call last):
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/gof/opt.py", line 1982, in process_node
    replacements = lopt.transform(node)
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1884, in local_shape_to_shape_i
    ret = shape_feature.make_vector_shape(node.inputs[0])
  File "/home/kotus/anaconda3/lib/python3.6/site-packages/theano/tensor/opt.py", line 1275, in make_vector_shape
    return make_vector(*self.shape_of[r])
KeyError: InplaceDimShuffle{0,2,3,1}.0

2017-05-08 09:04:39,913 - __main__ - INFO -         using specific model
2017-05-08 09:04:39,913 - models - INFO -         Preparing data
2017-05-08 09:04:40,010 - models - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-08 09:04:40,010 - models - INFO -         50000train samples
2017-05-08 09:04:40,010 - models - INFO -         10000test samples
2017-05-08 09:04:40,293 - models - INFO -         create model 5 alexnet...
2017-05-08 09:08:00,633 - __main__ - INFO -         using specific model
2017-05-08 09:08:00,633 - models - INFO -         Preparing data
2017-05-08 09:08:00,730 - models - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-08 09:08:00,730 - models - INFO -         50000train samples
2017-05-08 09:08:00,730 - models - INFO -         10000test samples
2017-05-08 09:08:01,013 - models - INFO -         create model 5 alexnet...
2017-05-08 09:08:01,864 - models - INFO -         fit model...
2017-05-08 09:15:18,343 - __main__ - INFO -         using range of models
2017-05-08 09:15:18,343 - models - INFO -         Preparing data
2017-05-08 09:15:18,440 - models - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-08 09:15:18,440 - models - INFO -         50000train samples
2017-05-08 09:15:18,440 - models - INFO -         10000test samples
2017-05-08 09:15:18,726 - models - INFO -         create model 1...
2017-05-08 09:15:19,386 - models - INFO -         fit model...
2017-05-08 23:24:55,298 - __main__ - INFO -         using range of models
2017-05-08 23:24:55,299 - models - INFO -         Preparing data
2017-05-08 23:24:55,396 - models - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-08 23:24:55,397 - models - INFO -         50000train samples
2017-05-08 23:24:55,397 - models - INFO -         10000test samples
2017-05-08 23:24:55,681 - models - INFO -         create model 1...
2017-05-08 23:24:56,382 - models - INFO -         fit model...
2017-05-09 05:24:20,436 - models - INFO -         dumping history to catalog: ../history/model1
2017-05-09 05:24:20,438 - models - INFO -         create model 2...
2017-05-09 05:24:21,299 - models - INFO -         fit model...
2017-05-09 11:03:46,680 - models - INFO -         dumping history to catalog: ../history/model2
2017-05-09 11:03:46,681 - models - INFO -         create model 3...
2017-05-09 11:03:46,947 - models - INFO -         fit model...
2017-05-09 14:03:15,201 - models - INFO -         dumping history to catalog: ../history/model3
2017-05-09 14:03:15,202 - models - INFO -         create model 4...
2017-05-09 14:03:15,891 - models - INFO -         fit model...
2017-05-09 22:54:36,397 - __main__ - INFO -         using specific model
2017-05-09 22:54:36,404 - models - INFO -         Preparing data
2017-05-09 22:54:36,519 - models - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-09 22:54:36,519 - models - INFO -         50000train samples
2017-05-09 22:54:36,519 - models - INFO -         10000test samples
2017-05-09 22:54:36,832 - models - INFO -         create model 4...
2017-05-09 22:54:38,631 - models - INFO -         fit model...
2017-05-10 05:13:18,862 - models - INFO -         dumping history to catalog: ../history/model4
2017-05-15 02:41:47,490 - data - INFO -         Preparing data
2017-05-15 02:41:49,095 - data - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-15 02:41:49,095 - data - INFO -         50000train samples
2017-05-15 02:41:49,095 - data - INFO -         10000test samples
2017-05-15 02:42:20,442 - data - INFO -         Preparing data
2017-05-15 02:42:20,543 - data - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-15 02:42:20,543 - data - INFO -         50000train samples
2017-05-15 02:42:20,543 - data - INFO -         10000test samples
2017-05-15 02:44:43,489 - data - INFO -         Preparing data
2017-05-15 02:44:43,586 - data - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-15 02:44:43,586 - data - INFO -         50000train samples
2017-05-15 02:44:43,586 - data - INFO -         10000test samples
2017-05-15 02:44:43,880 - models.learn_interface - INFO -         learning module initialized
2017-05-15 02:44:43,880 - models.model1 - INFO -         creating models.model1
2017-05-15 02:47:32,274 - data - INFO -         Preparing data
2017-05-15 02:47:32,371 - data - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-15 02:47:32,371 - data - INFO -         50000train samples
2017-05-15 02:47:32,371 - data - INFO -         10000test samples
2017-05-15 02:47:32,655 - models.learn_interface - INFO -         learning module initialized
2017-05-15 02:47:32,655 - models.model1 - INFO -         creating models.model1
2017-05-15 02:47:32,656 - models.model1 - INFO -         [32.0, 32.0, 32.0]
2017-05-15 02:48:22,676 - data - INFO -         Preparing data
2017-05-15 02:48:22,772 - data - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-15 02:48:22,773 - data - INFO -         50000train samples
2017-05-15 02:48:22,773 - data - INFO -         10000test samples
2017-05-15 02:48:23,060 - models.learn_interface - INFO -         learning module initialized
2017-05-15 02:48:23,060 - models.model1 - INFO -         creating models.model1
2017-05-15 02:48:23,060 - models.model1 - INFO -         [32, 32, 32]
2017-05-15 02:48:24,455 - models.learn_interface - INFO -         fit model...
2017-05-15 02:52:41,636 - data_ext - INFO -         Preparing data
2017-05-15 02:52:41,733 - data_ext - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-15 02:52:41,733 - data_ext - INFO -         50000train samples
2017-05-15 02:52:41,733 - data_ext - INFO -         10000test samples
2017-05-15 02:52:42,016 - models.learn_interface - INFO -         learning module initialized
2017-05-15 02:52:42,016 - models.model1 - INFO -         creating models.model1
2017-05-15 02:52:42,017 - models.model1 - INFO -         [32, 32, 32]
2017-05-15 02:52:43,140 - models.learn_interface - INFO -         fit model...
2017-05-15 02:53:19,052 - data_ext - INFO -         Preparing data
2017-05-15 02:53:19,150 - data_ext - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-15 02:53:19,150 - data_ext - INFO -         50000train samples
2017-05-15 02:53:19,150 - data_ext - INFO -         10000test samples
2017-05-15 02:53:19,441 - models.learn_interface - INFO -         learning module initialized
2017-05-15 02:53:19,441 - models.model1 - INFO -         creating models.model1
2017-05-15 02:53:19,441 - models.model1 - INFO -         [32, 32, 32]
2017-05-15 02:53:20,598 - models.learn_interface - INFO -         fit model...
2017-05-15 09:57:12,702 - data_ext - INFO -         Preparing data
2017-05-15 09:57:12,799 - data_ext - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-15 09:57:12,800 - data_ext - INFO -         50000train samples
2017-05-15 09:57:12,800 - data_ext - INFO -         10000test samples
2017-05-15 09:57:13,150 - models.learn_interface - INFO -         learning module initialized
2017-05-15 09:57:13,150 - models.model1 - INFO -         creating models.model1
2017-05-15 09:57:14,276 - models.learn_interface - INFO -         fit model...
2017-05-15 10:12:29,638 - data_ext - INFO -         Preparing data
2017-05-15 10:12:29,734 - data_ext - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-15 10:12:29,734 - data_ext - INFO -         50000train samples
2017-05-15 10:12:29,735 - data_ext - INFO -         10000test samples
2017-05-15 10:12:30,029 - models.learn_interface - INFO -         learning module initialized
2017-05-15 10:12:30,029 - models.model1 - INFO -         using template models.model1
2017-05-15 10:12:30,029 - models.model1 - INFO -         creating model M1-5(32,3)-32-32-32
2017-05-15 10:12:31,185 - models.learn_interface - INFO -         fit model...
2017-05-15 10:17:39,945 - data_ext - INFO -         Preparing data
2017-05-15 10:17:40,043 - data_ext - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-15 10:17:40,043 - data_ext - INFO -         50000train samples
2017-05-15 10:17:40,043 - data_ext - INFO -         10000test samples
2017-05-15 10:17:40,341 - models.learn_interface - INFO -         learning module initialized
2017-05-15 10:17:40,341 - models.model1 - INFO -         using template models.model1
2017-05-15 10:17:40,342 - models.model1 - INFO -         creating model M1-5(32,3)-32-32-32
2017-05-15 10:17:41,482 - models.learn_interface - INFO -         fit model...
2017-05-15 10:17:55,356 - monitor - INFO -         model trained in 0.129279 minutes
2017-05-15 10:17:55,357 - models.learn_interface - INFO -         time elapsed 13.874967
2017-05-15 10:18:31,392 - data_ext - INFO -         Preparing data
2017-05-15 10:18:31,488 - data_ext - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-15 10:18:31,488 - data_ext - INFO -         50000train samples
2017-05-15 10:18:31,489 - data_ext - INFO -         10000test samples
2017-05-15 10:18:31,788 - models.learn_interface - INFO -         learning module initialized
2017-05-15 10:18:31,788 - models.model1 - INFO -         using template models.model1
2017-05-15 10:18:31,788 - models.model1 - INFO -         creating model M1-5(32,3)-32-32-32
2017-05-15 10:18:32,915 - models.learn_interface - INFO -         fit model...
2017-05-15 10:18:42,292 - monitor - INFO -         model trained in 0.054976 minutes
2017-05-15 10:18:42,292 - models.learn_interface - INFO -         time elapsed 9.377417
2017-05-15 10:18:42,293 - models.learn_interface - INFO -         dumping history to catalog: ../history/M1-5(32,3)-32-32-32
2017-05-15 10:18:42,293 - models.model1 - INFO -         using template models.model1
2017-05-15 10:18:42,293 - models.model1 - INFO -         creating model M1-5(32,3)-64-64-64
2017-05-15 10:18:43,163 - models.learn_interface - INFO -         fit model...
2017-05-15 10:18:53,727 - monitor - INFO -         model trained in 0.066848 minutes
2017-05-15 10:18:53,727 - models.learn_interface - INFO -         time elapsed 10.564576
2017-05-15 10:18:53,727 - models.learn_interface - INFO -         dumping history to catalog: ../history/M1-5(32,3)-64-64-64
2017-05-15 10:18:53,728 - models.model1 - INFO -         using template models.model1
2017-05-15 10:18:53,728 - models.model1 - INFO -         creating model M1-5(32,3)-128-128-128
2017-05-15 10:18:54,848 - models.learn_interface - INFO -         fit model...
2017-05-15 10:19:06,357 - monitor - INFO -         model trained in 0.089862 minutes
2017-05-15 10:19:06,358 - models.learn_interface - INFO -         time elapsed 11.509999
2017-05-15 10:19:06,358 - models.learn_interface - INFO -         dumping history to catalog: ../history/M1-5(32,3)-128-128-128
2017-05-15 10:19:06,359 - models.model1 - INFO -         using template models.model1
2017-05-15 10:19:06,359 - models.model1 - INFO -         creating model M1-5(32,3)-256-256-256
2017-05-15 10:19:07,413 - models.learn_interface - INFO -         fit model...
2017-05-15 10:19:17,984 - monitor - INFO -         model trained in 0.075068 minutes
2017-05-15 10:19:17,984 - models.learn_interface - INFO -         time elapsed 10.571594
2017-05-15 10:19:17,984 - models.learn_interface - INFO -         dumping history to catalog: ../history/M1-5(32,3)-256-256-256
2017-05-15 10:19:17,985 - models.model1 - INFO -         using template models.model1
2017-05-15 10:19:17,985 - models.model1 - INFO -         creating model M1-5(32,3)-512-512-512
2017-05-15 10:19:19,154 - models.learn_interface - INFO -         fit model...
2017-05-15 10:19:30,761 - monitor - INFO -         model trained in 0.092758 minutes
2017-05-15 10:19:30,762 - models.learn_interface - INFO -         time elapsed 11.607285
2017-05-15 10:19:30,762 - models.learn_interface - INFO -         dumping history to catalog: ../history/M1-5(32,3)-512-512-512
2017-05-15 10:19:30,762 - models.model1 - INFO -         using template models.model1
2017-05-15 10:19:30,763 - models.model1 - INFO -         creating model M1-5(32,3)-64-32-16
2017-05-15 10:19:31,751 - models.learn_interface - INFO -         fit model...
2017-05-15 10:21:33,302 - data_ext - INFO -         Preparing data
2017-05-15 10:21:33,398 - data_ext - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-15 10:21:33,399 - data_ext - INFO -         50000train samples
2017-05-15 10:21:33,399 - data_ext - INFO -         10000test samples
2017-05-15 10:21:33,703 - models.learn_interface - INFO -         learning module initialized
2017-05-15 10:21:33,704 - models.model1 - INFO -         using template models.model1
2017-05-15 10:21:33,704 - models.model1 - INFO -         creating model M1-5(32,3)-32-32-32
2017-05-15 10:21:34,928 - models.learn_interface - INFO -         fit model...
2017-05-15 10:21:44,003 - monitor - INFO -         acc: 0.000000; val_acc: 0.080000; loss: 3.148001; val_loss: 2.325619
2017-05-15 10:21:44,003 - monitor - INFO -         model trained in 0.050252 minutes
2017-05-15 10:21:44,004 - models.learn_interface - INFO -         time elapsed 9.075424
2017-05-15 10:21:44,004 - models.learn_interface - INFO -         dumping history to catalog: ../history/M1-5(32,3)-32-32-32
2017-05-15 10:21:44,005 - models.model1 - INFO -         using template models.model1
2017-05-15 10:21:44,005 - models.model1 - INFO -         creating model M1-5(32,3)-64-64-64
2017-05-15 10:21:44,830 - models.learn_interface - INFO -         fit model...
2017-05-15 10:21:53,877 - monitor - INFO -         acc: 0.166667; val_acc: 0.080000; loss: 2.610902; val_loss: 2.326533
2017-05-15 10:21:53,877 - monitor - INFO -         model trained in 0.049525 minutes
2017-05-15 10:21:53,877 - models.learn_interface - INFO -         time elapsed 9.047514
2017-05-15 10:21:53,877 - models.learn_interface - INFO -         dumping history to catalog: ../history/M1-5(32,3)-64-64-64
2017-05-15 10:21:53,878 - models.model1 - INFO -         using template models.model1
2017-05-15 10:21:53,878 - models.model1 - INFO -         creating model M1-5(32,3)-128-128-128
2017-05-15 10:21:54,921 - models.learn_interface - INFO -         fit model...
2017-05-15 10:22:13,061 - monitor - INFO -         acc: 0.531250; val_acc: 0.040000; loss: 1.396705; val_loss: 2.284169
2017-05-15 10:22:13,061 - monitor - INFO -         model trained in 0.201411 minutes
2017-05-15 10:22:13,061 - models.learn_interface - INFO -         time elapsed 18.140440
2017-05-15 10:22:13,062 - models.learn_interface - INFO -         dumping history to catalog: ../history/M1-5(32,3)-128-128-128
2017-05-15 10:22:13,062 - models.model1 - INFO -         using template models.model1
2017-05-15 10:22:13,063 - models.model1 - INFO -         creating model M1-5(32,3)-256-256-256
2017-05-15 10:23:56,450 - data_ext - INFO -         Preparing data
2017-05-15 10:23:56,546 - data_ext - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-15 10:23:56,547 - data_ext - INFO -         50000train samples
2017-05-15 10:23:56,547 - data_ext - INFO -         10000test samples
2017-05-15 10:23:56,851 - models.learn_interface - INFO -         learning module initialized
2017-05-15 10:23:56,851 - models.model1 - INFO -         using template models.model1
2017-05-15 10:23:56,851 - models.model1 - INFO -         creating model M1-5(32,3)-32-32-32
2017-05-15 10:23:57,995 - models.learn_interface - INFO -         fit model...
2017-05-15 10:24:09,057 - monitor - INFO -         acc: 0.222222; val_acc: 0.080000; loss: 2.463432; val_loss: 2.329710
2017-05-15 10:24:09,057 - monitor - INFO -         model trained in 0.082211 minutes
2017-05-15 10:24:09,057 - models.learn_interface - INFO -         time elapsed 11.06 sec
2017-05-15 10:24:09,058 - models.learn_interface - INFO -         dumping history to catalog: ../history/M1-5(32,3)-32-32-32
2017-05-15 10:24:09,059 - models.model1 - INFO -         using template models.model1
2017-05-15 10:24:09,059 - models.model1 - INFO -         creating model M1-5(32,3)-64-64-64
2017-05-15 10:24:10,031 - models.learn_interface - INFO -         fit model...
2017-05-15 10:24:22,259 - monitor - INFO -         acc: 0.250000; val_acc: 0.080000; loss: 2.334876; val_loss: 2.306220
2017-05-15 10:24:22,259 - monitor - INFO -         model trained in 0.103031 minutes
2017-05-15 10:24:22,259 - models.learn_interface - INFO -         time elapsed 12.23 sec
2017-05-15 10:24:22,259 - models.learn_interface - INFO -         dumping history to catalog: ../history/M1-5(32,3)-64-64-64
2017-05-15 10:24:22,260 - models.model1 - INFO -         using template models.model1
2017-05-15 10:24:22,260 - models.model1 - INFO -         creating model M1-5(32,3)-128-128-128
2017-05-15 10:24:23,091 - models.learn_interface - INFO -         fit model...
2017-05-15 10:24:54,109 - data_ext - INFO -         Preparing data
2017-05-15 10:24:54,206 - data_ext - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-15 10:24:54,207 - data_ext - INFO -         50000train samples
2017-05-15 10:24:54,207 - data_ext - INFO -         10000test samples
2017-05-15 10:24:54,513 - models.learn_interface - INFO -         learning module initialized
2017-05-15 10:24:54,513 - models.model1 - INFO -         using template models.model1
2017-05-15 10:24:54,514 - models.model1 - INFO -         creating model M1-5(32,3)-32-32-32
2017-05-15 10:24:55,674 - models.learn_interface - INFO -         fit model...
2017-05-15 18:07:57,766 - monitor - INFO -         acc: 0.472522; val_acc: 0.526900; loss: 1.457871; val_loss: 1.322235
2017-05-15 18:07:57,766 - monitor - INFO -         model trained in 462.926927 minutes
2017-05-15 18:07:57,766 - models.learn_interface - INFO -         time elapsed 27782.09 sec
2017-05-15 18:07:57,766 - models.learn_interface - INFO -         dumping history to catalog: ../history/M1-5(32,3)-32-32-32
2017-05-15 18:07:57,767 - models.model1 - INFO -         using template models.model1
2017-05-15 18:07:57,767 - models.model1 - INFO -         creating model M1-5(32,3)-64-64-64
2017-05-15 18:07:58,567 - models.learn_interface - INFO -         fit model...
2017-05-16 05:58:35,073 - monitor - INFO -         acc: 0.560639; val_acc: 0.611700; loss: 1.258946; val_loss: 1.122730
2017-05-16 05:58:35,073 - monitor - INFO -         model trained in 710.506468 minutes
2017-05-16 05:58:35,073 - models.learn_interface - INFO -         time elapsed 42636.51 sec
2017-05-16 05:58:35,074 - models.learn_interface - INFO -         dumping history to catalog: ../history/M1-5(32,3)-64-64-64
2017-05-16 05:58:35,075 - models.model1 - INFO -         using template models.model1
2017-05-16 05:58:35,075 - models.model1 - INFO -         creating model M1-5(32,3)-128-128-128
2017-05-16 05:58:35,887 - models.learn_interface - INFO -         fit model...
2017-05-16 20:06:58,728 - monitor - INFO -         acc: 0.612872; val_acc: 0.638800; loss: 1.103154; val_loss: 1.010693
2017-05-16 20:06:58,728 - monitor - INFO -         model trained in 848.279698 minutes
2017-05-16 20:06:58,729 - models.learn_interface - INFO -         time elapsed 50902.84 sec
2017-05-16 20:06:58,729 - models.learn_interface - INFO -         dumping history to catalog: ../history/M1-5(32,3)-128-128-128
2017-05-16 20:06:58,730 - models.model1 - INFO -         using template models.model1
2017-05-16 20:06:58,730 - models.model1 - INFO -         creating model M1-5(32,3)-256-256-256
2017-05-16 20:06:59,583 - models.learn_interface - INFO -         fit model...
2017-05-17 06:37:05,222 - monitor - INFO -         acc: 0.627041; val_acc: 0.640800; loss: 1.053825; val_loss: 1.002067
2017-05-17 06:37:05,223 - monitor - INFO -         model trained in 629.992563 minutes
2017-05-17 06:37:05,223 - models.learn_interface - INFO -         time elapsed 37805.64 sec
2017-05-17 06:37:05,223 - models.learn_interface - INFO -         dumping history to catalog: ../history/M1-5(32,3)-256-256-256
2017-05-17 06:37:05,225 - models.model1 - INFO -         using template models.model1
2017-05-17 06:37:05,225 - models.model1 - INFO -         creating model M1-5(32,3)-512-512-512
2017-05-17 06:37:06,170 - models.learn_interface - INFO -         fit model...
2017-05-17 16:32:01,842 - monitor - INFO -         acc: 0.637628; val_acc: 0.640900; loss: 1.019509; val_loss: 1.019306
2017-05-17 16:32:01,843 - monitor - INFO -         model trained in 594.824689 minutes
2017-05-17 16:32:01,843 - models.learn_interface - INFO -         time elapsed 35695.67 sec
2017-05-17 16:32:01,843 - models.learn_interface - INFO -         dumping history to catalog: ../history/M1-5(32,3)-512-512-512
2017-05-17 16:32:01,844 - models.model1 - INFO -         using template models.model1
2017-05-17 16:32:01,844 - models.model1 - INFO -         creating model M1-5(32,3)-64-32-16
2017-05-17 16:32:02,661 - models.learn_interface - INFO -         fit model...
2017-05-18 04:36:14,638 - monitor - INFO -         acc: 0.422050; val_acc: 0.553100; loss: 1.580604; val_loss: 1.347154
2017-05-18 04:36:14,670 - monitor - INFO -         model trained in 724.097482 minutes
2017-05-18 04:36:14,671 - models.learn_interface - INFO -         time elapsed 43452.01 sec
2017-05-18 04:36:14,671 - models.learn_interface - INFO -         dumping history to catalog: ../history/M1-5(32,3)-64-32-16
2017-05-18 04:36:14,672 - models.model1 - INFO -         using template models.model1
2017-05-18 04:36:14,672 - models.model1 - INFO -         creating model M1-5(32,3)-128-64-32
2017-05-18 04:36:15,611 - models.learn_interface - INFO -         fit model...
2017-05-18 11:28:56,816 - monitor - INFO -         acc: 0.523155; val_acc: 0.586500; loss: 1.369091; val_loss: 1.218874
2017-05-18 11:28:56,817 - monitor - INFO -         model trained in 412.586067 minutes
2017-05-18 11:28:56,817 - models.learn_interface - INFO -         time elapsed 24761.21 sec
2017-05-18 11:28:56,817 - models.learn_interface - INFO -         dumping history to catalog: ../history/M1-5(32,3)-128-64-32
2017-05-18 11:28:56,818 - models.model1 - INFO -         using template models.model1
2017-05-18 11:28:56,818 - models.model1 - INFO -         creating model M1-5(32,3)-256-128-64
2017-05-18 11:28:57,647 - models.learn_interface - INFO -         fit model...
2017-05-18 21:58:42,525 - monitor - INFO -         acc: 0.581012; val_acc: 0.596200; loss: 1.207490; val_loss: 1.146207
2017-05-18 21:58:42,558 - monitor - INFO -         model trained in 629.649780 minutes
2017-05-18 21:58:42,558 - models.learn_interface - INFO -         time elapsed 37784.91 sec
2017-05-18 21:58:42,631 - models.learn_interface - INFO -         dumping history to catalog: ../history/M1-5(32,3)-256-128-64
2017-05-18 21:58:42,650 - models.model1 - INFO -         using template models.model1
2017-05-18 21:58:42,650 - models.model1 - INFO -         creating model M1-5(32,3)-512-256-128
2017-05-18 21:58:44,402 - models.learn_interface - INFO -         fit model...
2017-05-19 09:16:41,666 - monitor - INFO -         acc: 0.622659; val_acc: 0.620400; loss: 1.083486; val_loss: 1.071417
2017-05-19 09:16:41,699 - monitor - INFO -         model trained in 677.857422 minutes
2017-05-19 09:16:41,699 - models.learn_interface - INFO -         time elapsed 40677.30 sec
2017-05-19 09:16:41,738 - models.learn_interface - INFO -         dumping history to catalog: ../history/M1-5(32,3)-512-256-128
2017-05-19 09:16:41,759 - models.model2 - INFO -         using template models.model2
2017-05-19 09:16:41,759 - models.model2 - INFO -         creating model M2-5(32,3)-16
2017-05-19 09:16:42,943 - models.learn_interface - INFO -         fit model...
2017-05-19 22:18:18,053 - monitor - INFO -         acc: 0.430215; val_acc: 0.583600; loss: 1.539284; val_loss: 1.285672
2017-05-19 22:18:18,097 - monitor - INFO -         model trained in 781.442209 minutes
2017-05-19 22:18:18,097 - models.learn_interface - INFO -         time elapsed 46895.15 sec
2017-05-19 22:18:18,161 - models.learn_interface - INFO -         dumping history to catalog: ../history/M2-5(32,3)-16
2017-05-19 22:18:18,197 - models.model2 - INFO -         using template models.model2
2017-05-19 22:18:18,197 - models.model2 - INFO -         creating model M2-5(32,3)-32
2017-05-19 22:18:19,073 - models.learn_interface - INFO -         fit model...
2017-05-20 10:51:02,515 - monitor - INFO -         acc: 0.537724; val_acc: 0.620600; loss: 1.305539; val_loss: 1.137100
2017-05-20 10:51:02,515 - monitor - INFO -         model trained in 752.634960 minutes
2017-05-20 10:51:02,516 - models.learn_interface - INFO -         time elapsed 45163.44 sec
2017-05-20 10:51:02,537 - models.learn_interface - INFO -         dumping history to catalog: ../history/M2-5(32,3)-32
2017-05-20 10:51:02,539 - models.model2 - INFO -         using template models.model2
2017-05-20 10:51:02,539 - models.model2 - INFO -         creating model M2-5(32,3)-64
2017-05-20 10:51:03,362 - models.learn_interface - INFO -         fit model...
2017-05-20 20:22:53,393 - monitor - INFO -         acc: 0.611251; val_acc: 0.655400; loss: 1.114075; val_loss: 0.996320
2017-05-20 20:22:53,393 - monitor - INFO -         model trained in 571.755431 minutes
2017-05-20 20:22:53,394 - models.learn_interface - INFO -         time elapsed 34310.03 sec
2017-05-20 20:22:53,413 - models.learn_interface - INFO -         dumping history to catalog: ../history/M2-5(32,3)-64
2017-05-20 20:22:53,415 - models.model2 - INFO -         using template models.model2
2017-05-20 20:22:53,415 - models.model2 - INFO -         creating model M2-5(32,3)-128
2017-05-20 20:22:54,068 - models.learn_interface - INFO -         fit model...
2017-05-21 06:33:20,738 - monitor - INFO -         acc: 0.630884; val_acc: 0.657300; loss: 1.054720; val_loss: 0.980934
2017-05-21 06:33:20,789 - monitor - INFO -         model trained in 610.366463 minutes
2017-05-21 06:33:20,789 - models.learn_interface - INFO -         time elapsed 36626.72 sec
2017-05-21 06:33:20,825 - models.learn_interface - INFO -         dumping history to catalog: ../history/M2-5(32,3)-128
2017-05-21 06:33:20,826 - models.model2 - INFO -         using template models.model2
2017-05-21 06:33:20,826 - models.model2 - INFO -         creating model M2-5(32,3)-256
2017-05-21 06:33:21,473 - models.learn_interface - INFO -         fit model...
2017-05-22 00:52:45,201 - monitor - INFO -         acc: 0.661203; val_acc: 0.686800; loss: 0.948822; val_loss: 0.912908
2017-05-22 00:52:45,237 - monitor - INFO -         model trained in 1099.317191 minutes
2017-05-22 00:52:45,237 - models.learn_interface - INFO -         time elapsed 65963.76 sec
2017-05-22 00:52:45,318 - models.learn_interface - INFO -         dumping history to catalog: ../history/M2-5(32,3)-256
2017-05-22 00:52:45,337 - models.model2 - INFO -         using template models.model2
2017-05-22 00:52:45,337 - models.model2 - INFO -         creating model M2-5(32,3)-512
2017-05-22 00:52:47,290 - models.learn_interface - INFO -         fit model...
2017-05-22 10:38:07,113 - monitor - INFO -         acc: 0.662844; val_acc: 0.678600; loss: 0.951186; val_loss: 0.926719
2017-05-22 10:38:07,190 - monitor - INFO -         model trained in 585.254150 minutes
2017-05-22 10:38:07,190 - models.learn_interface - INFO -         time elapsed 35119.90 sec
2017-05-22 10:38:07,221 - models.learn_interface - INFO -         dumping history to catalog: ../history/M2-5(32,3)-512
2017-05-29 09:10:48,473 - data_ext - INFO -         Preparing data
2017-05-29 09:10:58,132 - data_ext - INFO -         x_train shape:(50000, 32, 32, 3)
2017-05-29 09:10:58,132 - data_ext - INFO -         50000train samples
2017-05-29 09:10:58,132 - data_ext - INFO -         10000test samples
2017-05-29 09:10:58,507 - models.learn_interface - INFO -         learning module initialized
2017-05-29 09:10:58,507 - models.model1 - INFO -         using template models.model1
2017-05-29 09:10:58,507 - models.model1 - INFO -         creating model M1-5(32,3)-ELU512-512-512
2017-05-29 09:11:12,408 - models.learn_interface - INFO -         fit model...
2017-05-29 21:55:41,024 - monitor - INFO -         acc: 0.673511; val_acc: 0.691800; loss: 0.929071; val_loss: 0.885198
2017-05-29 21:55:41,024 - monitor - INFO -         model trained in 764.034874 minutes
2017-05-29 21:55:41,025 - models.learn_interface - INFO -         time elapsed 45868.62 sec
2017-05-29 21:55:41,049 - models.learn_interface - INFO -         dumping history to catalog: ../history/M1-5(32,3)-ELU512-512-512
2017-05-29 21:55:41,050 - models.model1 - INFO -         using template models.model1
2017-05-29 21:55:41,054 - models.model1 - INFO -         creating model M1-5(32,3)-ELU1024-1024-1024
2017-05-29 21:55:42,130 - models.learn_interface - INFO -         fit model...
2017-05-30 11:59:00,811 - monitor - INFO -         acc: 0.709114; val_acc: 0.710900; loss: 0.826258; val_loss: 0.835307
2017-05-30 11:59:00,811 - monitor - INFO -         model trained in 843.203944 minutes
2017-05-30 11:59:00,812 - models.learn_interface - INFO -         time elapsed 50598.68 sec
2017-05-30 11:59:00,812 - models.learn_interface - INFO -         dumping history to catalog: ../history/M1-5(32,3)-ELU1024-1024-1024
2017-05-30 11:59:00,813 - models.model1 - INFO -         using template models.model1
2017-05-30 11:59:00,813 - models.model1 - INFO -         creating model M1-5(32,3)-ELU1024-512-256
2017-05-30 11:59:01,841 - models.learn_interface - INFO -         fit model...
2017-05-31 01:32:48,265 - monitor - INFO -         acc: 0.674852; val_acc: 0.690500; loss: 0.924253; val_loss: 0.879117
2017-05-31 01:32:48,359 - monitor - INFO -         model trained in 813.655324 minutes
2017-05-31 01:32:48,359 - models.learn_interface - INFO -         time elapsed 48826.52 sec
2017-05-31 01:32:48,448 - models.learn_interface - INFO -         dumping history to catalog: ../history/M1-5(32,3)-ELU1024-512-256
2017-05-31 01:32:48,492 - models.model2 - INFO -         using template models.model2
2017-05-31 01:32:48,492 - models.model2 - INFO -         creating model M2-5(32,3)-ELU256
2017-05-31 01:32:49,556 - models.learn_interface - INFO -         fit model...
2017-06-01 03:00:34,616 - monitor - INFO -         acc: 0.675052; val_acc: 0.705000; loss: 0.924840; val_loss: 0.842744
2017-06-01 03:00:34,710 - monitor - INFO -         model trained in 1527.646576 minutes
2017-06-01 03:00:34,710 - models.learn_interface - INFO -         time elapsed 91665.15 sec
2017-06-01 03:00:34,832 - models.learn_interface - INFO -         dumping history to catalog: ../history/M2-5(32,3)-ELU256
2017-06-01 03:00:34,877 - models.model2 - INFO -         using template models.model2
2017-06-01 03:00:34,877 - models.model2 - INFO -         creating model M2-5(32,3)-ELU512
2017-06-01 03:00:36,049 - models.learn_interface - INFO -         fit model...
2017-06-02 01:22:59,375 - monitor - INFO -         acc: 0.692483; val_acc: 0.702300; loss: 0.884316; val_loss: 0.848817
2017-06-02 01:22:59,435 - monitor - INFO -         model trained in 1342.292644 minutes
2017-06-02 01:22:59,436 - models.learn_interface - INFO -         time elapsed 80543.39 sec
2017-06-02 01:22:59,508 - models.learn_interface - INFO -         dumping history to catalog: ../history/M2-5(32,3)-ELU512
2017-06-02 01:22:59,535 - models.model2 - INFO -         using template models.model2
2017-06-02 01:22:59,536 - models.model2 - INFO -         creating model M2-5(32,3)-ELU1024
2017-06-02 01:23:00,501 - models.learn_interface - INFO -         fit model...
2017-06-02 14:36:29,672 - monitor - INFO -         acc: 0.699207; val_acc: 0.708100; loss: 0.861384; val_loss: 0.837028
2017-06-02 14:36:29,729 - monitor - INFO -         model trained in 793.390563 minutes
2017-06-02 14:36:29,729 - models.learn_interface - INFO -         time elapsed 47609.23 sec
2017-06-02 14:36:29,777 - models.learn_interface - INFO -         dumping history to catalog: ../history/M2-5(32,3)-ELU1024
